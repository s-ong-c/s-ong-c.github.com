{"expireTime":9007200822497052000,"key":"transformer-remark-markdown-html-21fca0c777fc5c8b9085800d1116eeed-gatsby-remark-imagesgatsby-remark-images-medium-zoomgatsby-remark-responsive-iframegatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypantsgatsby-remark-autolink-headersgatsby-remark-emoji-","val":"<h2 id=\"ssrserver-side-rendering\"><a href=\"#ssrserver-side-rendering\" aria-label=\"ssrserver side rendering permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSR(Server Side Rendering)?</h2>\n<p>말 그대로 서버사이드 렌더링은 서버로 부터 렌더링을 하겠다.<br>\n서버연산을 통해서 렌더링하고 페이지를 응답 하는 방법이 SSR <br>\nSSR의 경우에는 View를 서버에서 렌더링해 가져오기 때문에, 첫 로딩이 매우 짧다. <br>\nbut 물론 SSR을 사용하면 클라이언트에서 JS 파일을 모두 다운로드하고 적용하기 <br>\n전까지는 각각의 기능이 동작하지 않겠지만<br></p>\n<p><code class=\"language-text\">사용자의 입장에서는 매우 빠른 속도로 로딩이 되었다고 느낀다.!</code></p>\n<h2 id=\"spa--csr-렌더링-방식\"><a href=\"#spa--csr-%EB%A0%8C%EB%8D%94%EB%A7%81-%EB%B0%A9%EC%8B%9D\" aria-label=\"spa  csr 렌더링 방식 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SPA , CSR 렌더링 방식</h2>\n<p>한번만 리소스 로딩 하고 필요할 때마다만 서버와 통신해서 사용<br>\n요청하면 한페이만 불로서 이동시에 기존페이지를 수정해서 렌더링해주는 방식</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.27586206896551%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsSAAALEgHS3X78AAABYElEQVQoz4VTu26EMBDkG9Pk09KkzIekuCLp0qHoQOEKIGDeL2PzyuBFFjicbqRDPuPZ2Z0x1rIswzBwzheFaZrmeV7+YVYwNi38hBBBEDiOU9d1WZaMsaIopJRd1xFBVzT4K7nv+zzPQaiqKkkSz/Nc1w3DMI5j27ZRC/tMASchcCC3bQsmqkIByhDEJnWBV3iiNGqhO8biPEvXFjSZaLTAaUyBNVxARdpsmkZvsjQ7KD8EOEIOWFwc9vRyuUb1NW4wvmX4qV3FeOgCzWOK1TB1Jq7792/WirGT46Y8KeyrkBFZlqUKyPK0o83tKIp834cI71fc6x9Vp11aKxmRIgaYCYeSBMHA8FZKAcFxHClknfBskCGIJMnzr5/fIK24HJqO4+94hDGgRddTt/r8+vH2ebulXd5KUqGiJH5C3iNtBFdOnl5sfSMe5Awj0A4SxnM/pznzUWR7TV9IpHDP/z8hMms65580oAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ssr cra image\"\n        title=\"ssr cra image\"\n        src=\"/static/8b89cbe8fc34d5e3b44a911eaf910437/b9e4f/client-side-vs-server-side.png\"\n        srcset=\"/static/8b89cbe8fc34d5e3b44a911eaf910437/cf440/client-side-vs-server-side.png 148w,\n/static/8b89cbe8fc34d5e3b44a911eaf910437/d2d38/client-side-vs-server-side.png 295w,\n/static/8b89cbe8fc34d5e3b44a911eaf910437/b9e4f/client-side-vs-server-side.png 590w,\n/static/8b89cbe8fc34d5e3b44a911eaf910437/f9b6a/client-side-vs-server-side.png 885w,\n/static/8b89cbe8fc34d5e3b44a911eaf910437/2d849/client-side-vs-server-side.png 1180w,\n/static/8b89cbe8fc34d5e3b44a911eaf910437/5bfa4/client-side-vs-server-side.png 1740w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h3 id=\"ssr-장점\"><a href=\"#ssr-%EC%9E%A5%EC%A0%90\" aria-label=\"ssr 장점 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSR 장점</h3>\n<p>SEO(Search Engine Optimization, 검색 엔진 최적화)</p>\n<p>React or Vue 같은 자바스크립트 라이브러리는 엔진(자바스크립트 엔진) 동작하지 않으면 정보가 X\n따라서 HTML에 데이터를 담고 렌더링이 필요 할때 사용</p>\n<h3 id=\"ssr-단점\"><a href=\"#ssr-%EB%8B%A8%EC%A0%90\" aria-label=\"ssr 단점 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSR 단점</h3>\n<ul>\n<li>화면 이동시 화면 깜빡임(UX)</li>\n<li>\n<p>프로젝트에 복잡해진다.</p>\n<ul>\n<li>먼저 서버 코드에 있어서도 JSX를 사용할 수 있도록 빌드나 변환하는 과정이 필요</li>\n</ul>\n</li>\n<li>\n<p>성능 악화</p>\n<ul>\n<li>서버 렌더링에 따른 부하(성능)</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"서버사이드-렌더링-ready\"><a href=\"#%EC%84%9C%EB%B2%84%EC%82%AC%EC%9D%B4%EB%93%9C-%EB%A0%8C%EB%8D%94%EB%A7%81-ready\" aria-label=\"서버사이드 렌더링 ready permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>서버사이드 렌더링 READY!!</h2>\n<ul>\n<li>\n<p>환경</p>\n<ul>\n<li>typescript React</li>\n<li>@loadable/component</li>\n<li>react-router</li>\n<li>react-dom/server</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"servertsx-생성\"><a href=\"#servertsx-%EC%83%9D%EC%84%B1\" aria-label=\"servertsx 생성 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Server.tsx 생성</h3>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\n<span class=\"token keyword\">import</span> ReactDOMServer <span class=\"token keyword\">from</span> <span class=\"token string\">'react-dom/server'</span>\n<span class=\"token keyword\">import</span> Koa<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Middleware <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'koa'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> StaticRouter <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-router'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ChunkExtractor <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@loadable/server'</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> ServerStyleSheet <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'styled-components'</span>\n<span class=\"token keyword\">import</span> path <span class=\"token keyword\">from</span> <span class=\"token string\">'path'</span>\n<span class=\"token keyword\">import</span> App <span class=\"token keyword\">from</span> <span class=\"token string\">'./App'</span>\n\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Koa</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> clientStats <span class=\"token operator\">=</span> path<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./build/loadable-stats.json'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> ssr<span class=\"token punctuation\">:</span> <span class=\"token function-variable function\">Middleware</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token parameter\">ctx</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> context <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> extractor <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ChunkExtractor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> statsFile<span class=\"token punctuation\">:</span> clientStats <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> jsx <span class=\"token operator\">=</span> extractor<span class=\"token punctuation\">.</span><span class=\"token function\">collectChunks</span><span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>StaticRouter location<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>ctx<span class=\"token punctuation\">.</span>url<span class=\"token punctuation\">}</span> context<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>context<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>App <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>StaticRouter<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> sheet <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ServerStyleSheet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> rendered <span class=\"token operator\">=</span> ReactDOMServer<span class=\"token punctuation\">.</span><span class=\"token function\">renderToString</span><span class=\"token punctuation\">(</span>sheet<span class=\"token punctuation\">.</span><span class=\"token function\">collectStyles</span><span class=\"token punctuation\">(</span>jsx<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> scStyles <span class=\"token operator\">=</span> sheet<span class=\"token punctuation\">.</span><span class=\"token function\">getStyleTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> collected <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    script<span class=\"token punctuation\">:</span> extractor<span class=\"token punctuation\">.</span><span class=\"token function\">getScriptTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    link<span class=\"token punctuation\">:</span> extractor<span class=\"token punctuation\">.</span><span class=\"token function\">getLinkTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    style<span class=\"token punctuation\">:</span> extractor<span class=\"token punctuation\">.</span><span class=\"token function\">getScriptTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> scStyles<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> page <span class=\"token operator\">=</span> <span class=\"token function\">createPage</span><span class=\"token punctuation\">(</span>rendered<span class=\"token punctuation\">,</span> collected<span class=\"token punctuation\">)</span>\n\n  ctx<span class=\"token punctuation\">.</span>body <span class=\"token operator\">=</span> page\n<span class=\"token punctuation\">}</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>ssr<span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'SSR server listening to http://localhost:5000'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"webpack-설정\"><a href=\"#webpack-%EC%84%A4%EC%A0%95\" aria-label=\"webpack 설정 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>webpack 설정</h3>\n<ol>\n<li>config/paths.js 설정</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// config after eject: we're in ./config/</span>\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  dotenv<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.env'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  appPath<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  appBuild<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'build'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  appPublic<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'public'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  appHtml<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'public/index.html'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  appIndexJs<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveModule</span><span class=\"token punctuation\">(</span>resolveApp<span class=\"token punctuation\">,</span> <span class=\"token string\">'src/index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  appPackageJson<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'package.json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  appSrc<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  servedPath<span class=\"token punctuation\">:</span> <span class=\"token function\">getServedPath</span><span class=\"token punctuation\">(</span><span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'package.json'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>  <span class=\"token comment\">// 기존에 있던 내용들...</span>\n\n  <span class=\"token comment\">//추가한다.!!!</span>\n  ssrIndexJs<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'src/server'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  ssrBuild<span class=\"token punctuation\">:</span> <span class=\"token function\">resolveApp</span><span class=\"token punctuation\">(</span><span class=\"token string\">'dist'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ol start=\"2\">\n<li>(config/webpack.config.server.js)</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> webpack <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webpack'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> resolve <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resolve'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> PnpWebpackPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pnp-webpack-plugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> ModuleScopePlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-dev-utils/ModuleScopePlugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> getCSSModuleLocalIdent <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-dev-utils/getCSSModuleLocalIdent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> paths <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./paths'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> getClientEnvironment <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./env'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> ModuleNotFoundPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-dev-utils/ModuleNotFoundPlugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> ForkTsCheckerWebpackPlugin <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fork-ts-checker-webpack-plugin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> typescriptFormatter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-dev-utils/typescriptFormatter'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> nodeExternals <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webpack-node-externals'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token operator\">...</span>불필요 삭제\n\n<span class=\"token comment\">// This is the production and development configuration.</span>\n<span class=\"token comment\">// It is focused on developer experience, fast rebuilds, and a minimal bundle.</span>\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">webpackEnv</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> isEnvDevelopment <span class=\"token operator\">=</span> webpackEnv <span class=\"token operator\">===</span> <span class=\"token string\">'development'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> isEnvProduction <span class=\"token operator\">=</span> webpackEnv <span class=\"token operator\">===</span> <span class=\"token string\">'production'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token operator\">...</span>생략\n  <span class=\"token comment\">// path 설정</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        entry<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>paths<span class=\"token punctuation\">.</span>ssrIndexJs<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>Boolean<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        target<span class=\"token punctuation\">:</span> <span class=\"token string\">'node'</span><span class=\"token punctuation\">,</span>\n        externals<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token function\">nodeExternals</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        output<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// The build folder.</span>\n        path<span class=\"token punctuation\">:</span> paths<span class=\"token punctuation\">.</span>ssrABuild<span class=\"token punctuation\">,</span>\n        filename<span class=\"token punctuation\">:</span> <span class=\"token string\">'server.js'</span><span class=\"token punctuation\">,</span>\n        chunkFilename<span class=\"token punctuation\">:</span> isEnvProduction\n            <span class=\"token operator\">?</span> <span class=\"token string\">'static/js/[name].[chunkhash:8].chunk.js'</span>\n            <span class=\"token punctuation\">:</span> isEnvDevelopment <span class=\"token operator\">&amp;&amp;</span> <span class=\"token string\">'static/js/[name].chunk.js'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n\n\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>3.scripts/build.ssr 파일 설정</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// Do this as the first thing so that any code reading it knows the right env.</span>\nprocess<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">BABEL_ENV</span> <span class=\"token operator\">=</span> <span class=\"token string\">'production'</span>\nprocess<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">NODE_ENV</span> <span class=\"token operator\">=</span> <span class=\"token string\">'production'</span>\n\n<span class=\"token comment\">// Makes the script crash on unhandled rejections instead of silently</span>\n<span class=\"token comment\">// ignoring them. In the future, promise rejections that are not handled will</span>\n<span class=\"token comment\">// terminate the Node.js process with a non-zero exit code.</span>\nprocess<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'unhandledRejection'</span><span class=\"token punctuation\">,</span> <span class=\"token parameter\">err</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">throw</span> err\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Ensure environment variables are read.</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../config/env'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs-extra'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> webpack <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webpack'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> configFactory <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../config/webpack.config.server'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> paths <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'../config/paths'</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> checkRequiredFiles <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'react-dev-utils/checkRequiredFiles'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Warn and crash if required files are missing</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">checkRequiredFiles</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>paths<span class=\"token punctuation\">.</span>appHtml<span class=\"token punctuation\">,</span> paths<span class=\"token punctuation\">.</span>appIndexJs<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  process<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// Generate configuration</span>\n<span class=\"token keyword\">const</span> config <span class=\"token operator\">=</span> <span class=\"token function\">configFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">'production'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// Create the production build and print the deployment instructions.</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">previousFileSizes</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Creating an optimized production build...'</span><span class=\"token punctuation\">)</span>\n  fs<span class=\"token punctuation\">.</span><span class=\"token function\">emptyDirSync</span><span class=\"token punctuation\">(</span>paths<span class=\"token punctuation\">.</span>ssrBuild<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">let</span> compiler <span class=\"token operator\">=</span> <span class=\"token function\">webpack</span><span class=\"token punctuation\">(</span>config<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    compiler<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">err<span class=\"token punctuation\">,</span> stats</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>stats<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3 id=\"buildssr\"><a href=\"#buildssr\" aria-label=\"buildssr permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Build:SSR</h3>\n<ol>\n<li>package.json scripts 선언</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"start\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node scripts/start.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"build\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node scripts/build.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"build:ssr\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node scripts/build.ssr.js\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"node scripts/test.js\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<ol start=\"2\">\n<li>Build</li>\n</ol>\n<p><code class=\"language-text\">yarn build:ssr</code></p>\n<p>[console]</p>\n<p><img src=\"../img/react-ssr/ssr-build.png\" alt=\"ssr cra image\" title=\"ssr cra image\"></p>\n<p>[output]</p>\n<p><img src=\"../img/react-ssr/dist.png\" alt=\"ssr cra image\" title=\"ssr cra image\"></p>\n<ol start=\"3\">\n<li>server 실행\n<code class=\"language-text\">node ./dist/server.js</code></li>\n</ol>\n<p>서버사이드 연동 완료!!!\n<img src=\"../img/react-ssr/rendering.png\" alt=\"ssr cra image\" title=\"ssr cra image\"></p>\n<ul>\n<li>next 쓰면 간단하다고 들었는데 아직 안써보았다.</li>\n<li>webpack module은 뭐가 들어있는지는 참고 할 필요가 있는듯 싶다</li>\n</ul>\n<h2 id=\"references\"><a href=\"#references\" aria-label=\"references permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>References</h2>\n<br>\n<blockquote>\n<ul>\n<li><a href=\"https://velopert.com/3425\">velopert 블로그</a></li>\n<li><a href=\"https://serverless.com/\">https://serverless.com/</a></li>\n<li><a href=\"https://medium.com/aha-official/%EC%95%84%ED%95%98-%ED%94%84%EB%A1%A0%ED%8A%B8-%EA%B0%9C%EB%B0%9C%EA%B8%B0-1-spa%EC%99%80-ssr%EC%9D%98-%EC%9E%A5%EB%8B%A8%EC%A0%90-%EA%B7%B8%EB%A6%AC%EA%B3%A0-nuxt-js-cafdc3ac2053\">medium/아하 프론트 개발기(1) — SPA와 SSR의 장단점 그리고 Nuxt.js</a></li>\n</ul>\n</blockquote>"}